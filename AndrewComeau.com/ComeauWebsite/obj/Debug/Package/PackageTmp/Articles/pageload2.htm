<html>

<head>
<meta http-equiv="Content-Language" content="en-us">
<meta name="GENERATOR" content="Microsoft FrontPage 5.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<title>Drewslair.com - Sample Code</title>
</head>

<body>

<pre>For an explanation of this code, please see:
<a href="http://www.andrewcomeau.com/articles/201206100958.aspx">http://www.andrewcomeau.com/articles/201206100958.aspx</a></pre>
<pre>    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load</pre>
<pre><font color="#008000">        'Page load event - reads a random quote from the site_quotes file and displays it
        'as part of the page header section.</font></pre>
<pre>        Dim QuoteData As New DataSet
        Dim QuoteCount As Integer
        Dim QuoteSelect As Integer
        Dim QuoteRow As DataRow</pre>
<pre>        Try
 <font color="#008000">           'Use the timer to seed the random function.
</font>
            Randomize(Timer)
            
<font color="#008000">	    'Read XML file, count the quotes and select a random quote for display.
</font>
            QuoteData.ReadXml(&quot;http://www.drewslair.com/references/quotes.xml&quot;)
            QuoteCount = QuoteData.Tables(0).Rows.Count
            QuoteSelect = CInt(Int((QuoteCount * Rnd()) + 1))
            QuoteRow = QuoteData.Tables(0).Rows(QuoteSelect - 1)

   <font color="#008000">         'Send the quote strings to a function that will assemble the HTML for display
            'in the Literal control.
</font>
            QuoteBox.Text = QuoteBoxText(QuoteRow(0).ToString, QuoteRow(1).ToString)</pre>
<pre>        Catch ex As Exception</pre>
<pre>   <font color="#008000">         'Display default quote.
  </font>          QuoteBox.Text = QuoteBoxText(&quot;The law of unintended consequences governs all technological revolutions.&quot;, &quot;Arnold J. Toynbee&quot;)</pre>
<pre>        End Try</pre>
<pre>    End Sub</pre>

</body>

</html>
